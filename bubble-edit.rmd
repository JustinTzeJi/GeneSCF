loading libraries

```{r}
library(ggplot2)
library(ggrepel)
library(stringr)
```


BP_GO plot

```{r}
data <- read.delim("output/gene_list.list_GO_BP_GO_bps_functional_classification.tsv", header=TRUE)
data <- data[order(data$P.value),]
size <- length(data[,1])
data[,"Rank_in_order"] <- c(seq(1:length(data[,1])))
data <- data[,cbind("Rank_in_order","Process.name","percentage.","P.value")]
colnames(data) <- c("Rank_in_order","process","genes","Pvalue")
data <- data[1:20,]

newdata <- cbind(gsub( "~.*$", " ", data[,"process"]),data[,"Rank_in_order"])
colnames(newdata) <- c("IDs","Rank_in_order")
png(paste0("output/GO_BP_enrichment_plot.png"),width=900,height=625)
ggplot(data, aes(x=Rank_in_order, y=-log10(Pvalue), size=genes, label=newdata[,"IDs"],fill=str_wrap(paste0(data[,"process"]),35, 0, 0)),guide=FALSE)+
geom_point(colour="#2E2E2E", shape=21)+ 
scale_size_area(max_size = 5)+ 
labs(fill="Rank:Process (Top 20)")+
scale_x_continuous(name="Rank in order", limits=c(0,20))+
scale_y_continuous(name="-log10(Pvalue)")+
#scale_size_continuous(range=c(1, 15))+
geom_text_repel(size=4, color="#2E2E2E")+
geom_hline(yintercept=1.3)+
theme(text = element_text(size=14))
```

MF_GO plot

```{r}
data <- read.delim("output/gene_list.list_GO_MF_GO_bps_functional_classification.tsv", header=TRUE)
data <- data[order(data$P.value),]
size <- length(data[,1])
data[,"Rank_in_order"] <- c(seq(1:length(data[,1])))
data <- data[,cbind("Rank_in_order","Process.name","percentage.","P.value")]
colnames(data) <- c("Rank_in_order","process","genes","Pvalue")
data <- data[1:20,]

newdata <- cbind(gsub( "~.*$", " ", data[,"process"]),data[,"Rank_in_order"])
colnames(newdata) <- c("IDs","Rank_in_order")
png(paste0("output/GO_MF_enrichment_plot.png"),width=900,height=625)
ggplot(data, aes(x=Rank_in_order, y=-log10(Pvalue), size=genes, label=newdata[,"IDs"],fill=str_wrap(paste0(data[,"process"]),50, 0, 0)),guide=FALSE)+
geom_point(colour="#2E2E2E", shape=21)+ 
scale_size_area(max_size = 5)+ 
labs(fill="Rank:Process (Top 20)")+
scale_x_continuous(name="Rank in order", limits=c(0,20))+
scale_y_continuous(name="-log10(Pvalue)")+
#scale_size_continuous(range=c(1, 15))+
geom_text_repel(size=4, color="#2E2E2E")+
geom_hline(yintercept=1.3)+
theme(text = element_text(size=14))
```

CC_GO plot

```{r}
data <- read.delim("output/gene_list.list_GO_CC_GO_bps_functional_classification.tsv", header=TRUE)
data <- data[order(data$P.value),]
size <- length(data[,1])
data[,"Rank_in_order"] <- c(seq(1:length(data[,1])))
data <- data[,cbind("Rank_in_order","Process.name","percentage.","P.value")]
colnames(data) <- c("Rank_in_order","process","genes","Pvalue")
data <- data[1:20,]

newdata <- cbind(gsub( "~.*$", " ", data[,"process"]),data[,"Rank_in_order"])
colnames(newdata) <- c("IDs","Rank_in_order")
png(paste0("output/GO_CC_enrichment_plot.png"),width=900,height=625)
ggplot(data, aes(x=Rank_in_order, y=-log10(Pvalue), size=genes, label=newdata[,"IDs"],fill=str_wrap(paste0(data[,"process"]),35, 0, 0)),guide=FALSE)+
geom_point(colour="#2E2E2E", shape=21)+ 
scale_size_area(max_size = 5)+ 
labs(fill="Rank:Process (Top 20)")+
scale_x_continuous(name="Rank in order", limits=c(0,20))+
scale_y_continuous(name="-log10(Pvalue)")+
#scale_size_continuous(range=c(1, 15))+
geom_text_repel(size=4, color="#2E2E2E")+
geom_hline(yintercept=1.3)+
theme(text = element_text(size=14))
```

KEGG plot

```{r}
data <- read.delim("output/gene_list.list_KEGG_bps_functional_classification.tsv", header=TRUE)
data <- data[order(data$P.value),]
size <- length(data[,1])
data[,"Rank_in_order"] <- c(seq(1:length(data[,1])))
data <- data[,cbind("Rank_in_order","Process.name","percentage.","P.value")]
colnames(data) <- c("Rank_in_order","process","genes","Pvalue")
data <- data[1:20,]

newdata <- cbind(gsub( "~.*$", "", data[,"process"]),data[,"Rank_in_order"])
colnames(newdata) <- c("IDs","Rank_in_order")
png(paste0("output/KEGG_enrichment_plot.png"),width=900,height=625)
ggplot(data, aes(x=Rank_in_order, y=-log10(Pvalue), size=genes, label=newdata[,"IDs"],fill=paste0(data[,"process"])),guide=FALSE)+
geom_point(colour="#2E2E2E", shape=21)+ 
scale_size_area(max_size = 5)+ 
labs(fill="Rank:Process (Top 20)")+
scale_x_continuous(name="Rank in order", limits=c(0,20))+
scale_y_continuous(name="-log10(Pvalue)")+
#scale_size_continuous(range=c(1, 15))+
geom_text_repel(size=4, color="#2E2E2E")+
geom_hline(yintercept=1.3)+
theme(text = element_text(size=14))
```